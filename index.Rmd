---
title: "Avicii vs Kygo"
author: "Cas Gerritsen"
date: "2024-02-20"
output:
  flexdashboard::flex_dashboard:
    orientation: columns
    storyboard: true
---

```{r}
library(tidyverse)
library(spotifyr)
library(ggplot2)
library(plotly)
library(compmus)
library(gridExtra)
library(flexdashboard)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Home
===================================== 

<style type="text/css">

.overview {
   font-size: 15px;
}

.myDiv {
  width: 600px;
  height: 500px;
  overflow: auto;
}
</style>
<!-- # Chapter 1: Intro -->
Column {data-width=500}
-----------------------------------------------------------------------
### Overview {.overview}

<!-- ## Overview Research? -->
Embark on a melodic journey through the evolution of electronic dance music as we delve into the dynamic soundscapes of two iconic artists: Avicii and Kygo. In this captivating exploration, we dissect the metamorphosis of musical style over the years, meticulously analyzing the sonic innovations and creative ingenuity that have defined the discographies of these electronic titans. <br>
<br>
Why Avicii and Kygo, you may wonder? Beyond their chart-topping hits and global acclaim, these virtuosos hold a special place in the heart of the researcher. Year after year, their captivating compositions have dominated the coveted slots of the Spotify Wrapped Top 5 Artists, a testament not only to their immense popularity but also to the profound connection forged between their music and the listener's soul.<br>
<br>
Prepare to be entranced as we unravel the intricacies of Avicii's groundbreaking melodies, tracing the evolution from his euphoric anthems to the poignant depths of his later works. Contrast this with the tropical-infused beats and sun-kissed vibes that hallmark Kygo's signature sound, a testament to his ability to transport listeners to exotic locales through the power of music.<br>
<br>
Through meticulous analysis and keen observation, we aim to unravel the mysteries behind the ever-changing tapestry of sound, exploring how Avicii and Kygo have sculpted and redefined the landscape of electronic music. Join us on this exhilarating expedition, where passion meets precision, and every beat resonates with the pulse of innovation.<br>

Column {.tabset}
-----------------------------------------------------------------------
### **The story of Avicii**
 
Tim Bergling (8 September 1989 – 20 April 2018), known professionally as Avicii, was a Swedish musician, DJ, remixer, and record producer.<br>
<br>
At 16, Bergling began posting his remixes on electronic music forums, which led to his first record deal. He rose to prominence in 2011 with his single "Levels". His debut studio album, True (2013), blended electronic music with elements of multiple genres and received generally positive reviews. It peaked in the top ten in more than fifteen countries and topped international dance charts; the lead single, "Wake Me Up", topped most music markets in Europe and reached number four in the United States.<br>
<br>
In 2015, Bergling released his second studio album, Stories, and in 2017 he released an EP, Avīci (01).[8] His catalogue also included the singles "I Could Be the One" with Nicky Romero, "You Make Me", "X You", "Hey Brother", "Addicted to You", "The Days", "The Nights", "Waiting for Love", "Without You" and "Lonely Together". Bergling was nominated for a Grammy Award for his work on "Sunshine" with David Guetta in 2012[9] and "Levels" in 2013. Several music publications credit Bergling as among the DJs who ushered electronic music into Top 40 radio in the early 2010s.<br>
<br>
Bergling retired from touring in 2016 due to health problems, having suffered stress and poor mental health for several years.[12] On 20 April 2018, Avicii was found dead in Muscat, Oman. On 1 May, it was reported that the cause of his death was suicide from self-inflicted injuries from a broken wine bottle. He was buried on 8 June in his hometown of Stockholm, Sweden.<br>
<br>
![alt text](avicii.jpg "Title")
<br>
(https://simple.wikipedia.org/wiki/Avicii)

### **The story of Kygo**

Kyrre Gørvell-Dahll (born 11 September 1991), known professionally as Kygo, is a Norwegian DJ and record producer. He garnered international attention with his December 2013 remix of the track "I See Fire" by Ed Sheeran and his December 2014 single "Firestone" (featuring Conrad Sewell). In late 2015, he reached 1 billion streams on Spotify faster than any other artist, and by June 2016, he had reached 2 billion streams. <br>
<br>
Kygo has since released several singles, such as "Stole the Show", "Here for You", and "Stay" in 2015, "It Ain't Me" collaborating with Selena Gomez in 2017 and a 2019 remix of "Higher Love" performed by Whitney Houston, all of which have debuted on several international charts. His debut album, Cloud Nine, was released on 13 May 2016.<br>
<br>
Kygo became the first house music producer to perform at an Olympics closing ceremony in August 2016 at the 2016 Rio Olympics. In March 2018, Billboard ranked Kygo 3rd on its 2018 ranking of dance musicians titled Billboard Dance 100. The same year, he was ranked 32 on DJ Mag's top 100 DJs of the world, and in October 2019 he was ranked 42. <br>
<br>
![alt text](Kygo.jpg "Title")
<br>
(https://en.wikipedia.org/wiki/Kygo)

The Corpus
===================================== 

Column {data-width=500}
-----------------------------------------------------------------------
<!-- # The Corpus -->

```{r,  echo = FALSE}
kygo_playlist_url <- "2M0XZxqAd3THfF3xWLJlSi"
avicii_playlist_url <- "3ucGSj6sO3iLaQin2jfyQh"

# Retrieve audio features for Kygo's playlist
kygo_features <- get_playlist_audio_features("", kygo_playlist_url)
kygo_features$artist <- "Kygo"

# Retrieve audio features for Avicii's playlist
avicii_features <- get_playlist_audio_features("", avicii_playlist_url)
avicii_features$artist <- "Avicii"

# Combine the data for both artists into a single data frame
combined_data <- rbind(kygo_features, avicii_features)
```

### About the corpus
Blablabla over the corpus (hvl nummers each, average duration track.duration_ms)
The corpus exists of two playlists; one of each artist. I picked all the songs that are in a album and most of the singles to create these playlists. I did not include remixes, or songs where the artist took part of, but is not featured in it. <br>
I put some interesting stats about the playlist in the following table: <br>
```{r, echo=FALSE}
# Create a matrix with the data
data <- matrix(NA, nrow = 4, ncol = 2, dimnames = list(c("Number of songs", "Average duration (in seconds)", "Oldest song", "Newest song"), c("Avicii", "Kygo")))

data[1, ] <- c(49, 82)
data[2, ] <- c((mean(avicii_features$track.duration_ms)/1000), (mean(kygo_features$track.duration_ms)/1000))
data[3, ] <- c("Levels (2011)", "Epsilon (2013)")
data[4, ] <- c("Forever yours (Avicii Tribute) (2020)", "Whatever (2024)") 

print(data)
```

Column {.tabset}
-----------------------------------------------------------------------
### Energy
<div class="myDiv">
```{r, echo = FALSE}

# Plotting
ggplot(combined_data, aes(x = artist, y = energy, fill = artist)) +
  geom_boxplot(position = position_dodge(width = 0.8)) +
  labs(title = "Comparison of Energy Between Kygo and Avicii",
       x = "Artist",
       y = "Energy") +
  theme_minimal()
```
</div>
### Danceability
<div class="myDiv">
```{r, echo = FALSE}
ggplot(combined_data, aes(x = artist, y = danceability, fill = artist)) +
  geom_boxplot(position = position_dodge(width = 0.8)) +
  labs(title = "Comparison of Danceability Between Kygo and Avicii",
       x = "Artist",
       y = "Danceability") +
  theme_minimal()
```
</div>
### Acousticness
<div class="myDiv">
```{r, echo = FALSE}
ggplot(combined_data, aes(x = artist, y = acousticness, fill = artist)) +
  geom_boxplot(position = position_dodge(width = 0.8)) +
  labs(title = "Comparison of Acousticness Between Kygo and Avicii",
       x = "Artist",
       y = "Acousticness") +
  theme_minimal()
```
</div>

Over the years
=====================================
Column {data-width=333}
-----------------------------------------------------------------------

### About the plots
Verschillende albums analyseren

Column {.tabset}
-----------------------------------------------------------------------

### True

### Stories

### TIM

Column {.tabset}
-----------------------------------------------------------------------

### Cloud Nine

### Kids in Love

### Golden hour

### Thrill Of The Chase


Cepstrograms
=====================================
Column {data-width=500}
-----------------------------------------------------------------------

### About the plots
Below are two cepstrograms; one of Kygo's 'Higher Love' and one of Avicii's 'Hey Brother'. These songs are chosen, because of the popularity, as the two are relatively in the middle in terms of streams. Also, the researcher's personal interest is another reason. <br>

Column {.tabset}
-----------------------------------------------------------------------
### Higher Love - Kygo, Whitney Houston
<div class="myDiv">
```{r, echo=FALSE}
# Retrieve audio features for a single track from Spotify
track_id_higher_love <- "6oJ6le65B3SEqPwMRNXWjY" # Higher Love
```

```{r, echo=FALSE}
bzt <-
  get_tidy_audio_analysis(track_id_higher_love) |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )
```

```{r, echo=FALSE}
bzt |>
  compmus_gather_timbre() |>
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic() + ggtitle("Cepstrogram of 'Higher Love'")
```
</div>
### Hey Brother - Avicii
<div class="myDiv">
```{r, echo=FALSE}
# Retrieve audio features for a single track from Spotify
track_id_hey_brother <- "4lhqb6JvbHId48OUJGwymk" # Hey Brother
```

```{r, echo=FALSE}
bzt <-
  get_tidy_audio_analysis(track_id_hey_brother) |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )
```

```{r, echo=FALSE}
bzt |>
  compmus_gather_timbre() |>
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic() + ggtitle("Cepstrogram of 'Hey Brother'")
```
</div>

Chordograms
=====================================
Column {data-width=500}
-----------------------------------------------------------------------
Die chordogrammetjes weetjewel

Column {.tabset}
-----------------------------------------------------------------------
```{r, echo=FALSE}
circshift <- function(v, n) {
  if (n == 0) v else c(tail(v, n), head(v, -n))
}

#      C     C#    D     Eb    E     F     F#    G     Ab    A     Bb    B
major_chord <-
  c(   1,    0,    0,    0,    1,    0,    0,    1,    0,    0,    0,    0)
minor_chord <-
  c(   1,    0,    0,    1,    0,    0,    0,    1,    0,    0,    0,    0)
seventh_chord <-
  c(   1,    0,    0,    0,    1,    0,    0,    1,    0,    0,    1,    0)

major_key <-
  c(6.35, 2.23, 3.48, 2.33, 4.38, 4.09, 2.52, 5.19, 2.39, 3.66, 2.29, 2.88)
minor_key <-
  c(6.33, 2.68, 3.52, 5.38, 2.60, 3.53, 2.54, 4.75, 3.98, 2.69, 3.34, 3.17)

chord_templates <-
  tribble(
    ~name, ~template,
    "Gb:7", circshift(seventh_chord, 6),
    "Gb:maj", circshift(major_chord, 6),
    "Bb:min", circshift(minor_chord, 10),
    "Db:maj", circshift(major_chord, 1),
    "F:min", circshift(minor_chord, 5),
    "Ab:7", circshift(seventh_chord, 8),
    "Ab:maj", circshift(major_chord, 8),
    "C:min", circshift(minor_chord, 0),
    "Eb:7", circshift(seventh_chord, 3),
    "Eb:maj", circshift(major_chord, 3),
    "G:min", circshift(minor_chord, 7),
    "Bb:7", circshift(seventh_chord, 10),
    "Bb:maj", circshift(major_chord, 10),
    "D:min", circshift(minor_chord, 2),
    "F:7", circshift(seventh_chord, 5),
    "F:maj", circshift(major_chord, 5),
    "A:min", circshift(minor_chord, 9),
    "C:7", circshift(seventh_chord, 0),
    "C:maj", circshift(major_chord, 0),
    "E:min", circshift(minor_chord, 4),
    "G:7", circshift(seventh_chord, 7),
    "G:maj", circshift(major_chord, 7),
    "B:min", circshift(minor_chord, 11),
    "D:7", circshift(seventh_chord, 2),
    "D:maj", circshift(major_chord, 2),
    "F#:min", circshift(minor_chord, 6),
    "A:7", circshift(seventh_chord, 9),
    "A:maj", circshift(major_chord, 9),
    "C#:min", circshift(minor_chord, 1),
    "E:7", circshift(seventh_chord, 4),
    "E:maj", circshift(major_chord, 4),
    "G#:min", circshift(minor_chord, 8),
    "B:7", circshift(seventh_chord, 11),
    "B:maj", circshift(major_chord, 11),
    "D#:min", circshift(minor_chord, 3)
  )

key_templates <-
  tribble(
    ~name, ~template,
    "Gb:maj", circshift(major_key, 6),
    "Bb:min", circshift(minor_key, 10),
    "Db:maj", circshift(major_key, 1),
    "F:min", circshift(minor_key, 5),
    "Ab:maj", circshift(major_key, 8),
    "C:min", circshift(minor_key, 0),
    "Eb:maj", circshift(major_key, 3),
    "G:min", circshift(minor_key, 7),
    "Bb:maj", circshift(major_key, 10),
    "D:min", circshift(minor_key, 2),
    "F:maj", circshift(major_key, 5),
    "A:min", circshift(minor_key, 9),
    "C:maj", circshift(major_key, 0),
    "E:min", circshift(minor_key, 4),
    "G:maj", circshift(major_key, 7),
    "B:min", circshift(minor_key, 11),
    "D:maj", circshift(major_key, 2),
    "F#:min", circshift(minor_key, 6),
    "A:maj", circshift(major_key, 9),
    "C#:min", circshift(minor_key, 1),
    "E:maj", circshift(major_key, 4),
    "G#:min", circshift(minor_key, 8),
    "B:maj", circshift(major_key, 11),
    "D#:min", circshift(minor_key, 3)
  )

```
### The Nights - Avicii
<div class="myDiv">
```{r, echo=FALSE}
twenty_five <-
  get_tidy_audio_analysis("0ct6r3EGTcMLPtrXHDvVjc") |> # The Nights
  compmus_align(sections, segments) |>
  select(sections) |>
  unnest(sections) |>
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "mean", norm = "manhattan"
      )
  )

twenty_five |> 
  compmus_match_pitch_template(
    key_templates,         # Change to chord_templates if descired
    method = "manhattan",  # Try different distance metrics
    norm = "euclidean"     # Try different norms
  ) |>
  ggplot(
    aes(x = start + duration / 2, width = duration, y = name, fill = d)
  ) +
  geom_tile() +
  scale_fill_viridis_c(guide = "none") +
  theme_minimal() +
  labs(x = "Time (s)", y = "") + ggtitle("Chordogram of 'The Nights'")
```
</div>
### Raging - Kygo, Kodaline
<div class="myDiv">
```{r, echo=FALSE}
twenty_five <-
  get_tidy_audio_analysis("2Vhd5uZB4brKHmM0MNxkZo") |> # Raging
  compmus_align(sections, segments) |>
  select(sections) |>
  unnest(sections) |>
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "mean", norm = "manhattan"
      )
  )

twenty_five |> 
  compmus_match_pitch_template(
    key_templates,         # Change to chord_templates if descired
    method = "manhattan",  # Try different distance metrics
    norm = "euclidean"     # Try different norms
  ) |>
  ggplot(
    aes(x = start + duration / 2, width = duration, y = name, fill = d)
  ) +
  geom_tile() +
  scale_fill_viridis_c(guide = "none") +
  theme_minimal() +
  labs(x = "Time (s)", y = "") + ggtitle("Chordogram of 'Raging'")
```
</div>

Something with tempo
=====================================

Column {data-width=500}
-----------------------------------------------------------------------
### About the plots
On the right, there are two 'novelty-grams'. One of Avicii's 'You make me' and the other is Kygo's 'Stargazing. I set the time to 110 sec, because that is the part after the first drop for both songs.Here you can see that the start of Stargazing is calm compared to You make me. Also, the line of Stargazing is moving somewhat more, whereas the average line of You make me would be more straight. To be honest, I expected more differences, because the songs do differ a lot in tempo.<br>
<br>
Note: I wanted to make a tempogram of the songs, but I kept getting an error, where I had to restart the kernel and I do not know why this is the case.

Column {.tabset}
-----------------------------------------------------------------------
### You make me - Avicii
<div class="myDiv">
```{r, echo=FALSE}
pata_pata <-
  get_tidy_audio_analysis("6PJasPKAzNLSOzxeAH33j2") |>
  select(segments) |>
  unnest(segments)
pata_pata |>
  arrange(start) |>
  mutate(timbre = map2(timbre, lag(timbre), `-`)) |>
  slice(-1) |>
  compmus_gather_timbre() |>
  group_by(start, duration) |> 
  summarise(novelty = sum(log1p(pmax(value, 0)))) |> 
  ggplot(aes(x = start + duration / 2, y = novelty)) +
  geom_line() +
  xlim(0, 110) +
  theme_minimal() +
  labs(x = "Time (s)", y = "Novelty")
```
</div>
### Stargazing - Kygo
<div class="myDiv">
```{r, echo=FALSE}
pata_pata <-
  get_tidy_audio_analysis("0Zbbxnx4SGGHoIow4PpISP") |>
  select(segments) |>
  unnest(segments)
pata_pata |>
  arrange(start) |>
  mutate(timbre = map2(timbre, lag(timbre), `-`)) |>
  slice(-1) |>
  compmus_gather_timbre() |>
  group_by(start, duration) |> 
  summarise(novelty = sum(log1p(pmax(value, 0)))) |> 
  ggplot(aes(x = start + duration / 2, y = novelty)) +
  geom_line() +
  xlim(0, 110) +
  theme_minimal() +
  labs(x = "Time (s)", y = "Novelty")
```
</div>